Important Functions
-------------------

The *internal* MD5 implementation is located at 0x099A54B2 in
"i86bi-linux-l3-ipbase-12.4.bin" file.

We can look for the constants used in the MD5 algorithm.

http://openwall.info/wiki/_media/people/solar/software/public-domain-source-code/md5.c

Searching for "0xd76aa478" (a constant used in MD5) leads us to 0x099A54B2. We
compare this function with Solar's md5.c and see that it is "MD5_body".

This looks like a standard MD5 implementation without any Cisco specific craziness.

NOTE: The external MD5 functionality is used for license checking stuff only.

GDB tracing
-----------

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a6000c:	0x02	0x05	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60014:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a6001c:	0x00	0x00	0x00	0x2a	0x00	0x02	0x00	0x28
0xf2a60024:	0x00	0x02	0x00	0x10	0x00	0x00	0x00	0x01
0xf2a6002c:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60034:	0x00	0x00	0x00	0x00	0x70	0x61	0x73	0x73
0xf2a6003c:	0x77	0x6f	0x72	0x64	0x31	0x32	0x33	0x34
0xf2a60044:	0x35	0x00	0x00	0x00	0x80	0x00	0x00	0x00

# "password12345" is at offset 44

(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a6000c:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60014:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a6001c:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60024:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a6002c:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60034:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a6003c:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a60044:	0xe0	0x01	0x00	0x00	0x00	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x02	0x05	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x2a	0x00	0x02	0x00	0x28
0xf2a4d580:	0x00	0x02	0x00	0x10	0x00	0x00	0x00	0x01
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x70	0x61	0x73	0x73
0xf2a4d598:	0x77	0x6f	0x72	0x64	0x31	0x32	0x33	0x34
0xf2a4d5a0:	0x35	0x00	0x00	0x00	0x80	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d580:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d598:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d5a0:	0xe0	0x01	0x00	0x00	0x00	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x02	0x05	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x2a	0x00	0x02	0x00	0x28
0xf2a4d580:	0x00	0x02	0x00	0x10	0x00	0x00	0x00	0x01
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x70	0x61	0x73	0x73
0xf2a4d598:	0x77	0x6f	0x72	0x64	0x31	0x32	0x33	0x34
0xf2a4d5a0:	0x35	0x00	0x00	0x00	0x80	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d580:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d598:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d5a0:	0xe0	0x01	0x00	0x00	0x00	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x02	0x05	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x2a	0x00	0x02	0x00	0x28
0xf2a4d580:	0x00	0x02	0x00	0x10	0x00	0x00	0x00	0x01
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x70	0x61	0x73	0x73
0xf2a4d598:	0x77	0x6f	0x72	0x64	0x31	0x32	0x33	0x34
0xf2a4d5a0:	0x35	0x00	0x00	0x00	0x80	0x00	0x00	0x00
(gdb) c
Continuing.

Breakpoint 1, 0x099a54b2 in ?? ()
(gdb) x/64xb $ecx
0xf2a4d568:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d570:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d578:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d580:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d588:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d590:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d598:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0xf2a4d5a0:	0xe0	0x01	0x00	0x00	0x00	0x00	0x00	0x00
(gdb) c



Setup
-----

# echo '127.42.42.42 xml.cisco.com' >> /etc/hosts

$ ./CiscoIOUKeygen.py > iourc  # generate license

$ ./start-1.sh

$ ./start-2.sh

$ ./iousniff -i /tmp/netio1000/  # used for capturing traffic between the routers

Links
-----

http://evilrouters.net/2009/07/04/eigrp-authentication/

Extra
-----

sudo apt-get install libnet-pcap-perl libpcap0.8

sudo apt-get install uml-utilities bridge-utils

...
